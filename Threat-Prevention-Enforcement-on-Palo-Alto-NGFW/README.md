![Topology](topology.png)

![Validation](validation-1.png)

![Validation](validation-2.png)

# Lab â€“ Threat Prevention Enforcement on Palo Alto NGFW

## Overview
This lab examines how a Palo Alto Networks next-generation firewall enforces Threat Prevention controls by inspecting and blocking malicious content within otherwise permitted outbound traffic. The focus is on observable enforcement behavior at the security policy layer during live traffic flow.

This lab is documented as a validated engineering case note rather than a configuration walkthrough.

## Lab Objectives
- Confirm that Threat Prevention inspection is applied to permitted outbound traffic
- Verify inline blocking behavior for known malware and spyware signatures
- Observe user-visible enforcement generated by policy-based inspection
- Confirm that security outcomes occur without reliance on explicit deny rules

## Topology Summary
The topology consists of a Palo Alto Networks NGFW positioned between an internal trusted zone and an external untrusted zone representing the internet. An internal user system initiates outbound web traffic that traverses the firewall, where Threat Prevention inspection is enforced prior to egress. Management access is maintained through a dedicated management interface.

## Configuration Summary
- Security policy permitting outbound traffic from the Inside zone to the Outside zone
- Antivirus and Anti-Spyware profiles applied directly to the outbound allow rule
- Inline Threat Prevention inspection enforced on permitted traffic flows

(Configuration details intentionally omitted; focus is on behavior and validation.)

## Validation and Results

### Behavior Without the Control
When Threat Prevention profiles are not applied to the outbound security policy, permitted web traffic completes without content inspection, allowing test malware files to download successfully.

### Behavior With the Control
After Threat Prevention profiles are applied, outbound traffic is inspected inline. Malware test file download attempts are actively blocked, and the user is presented with a Palo Alto Networks Virus/Spyware block response, confirming enforcement occurred during the allowed session.

## Key Takeaways
- Threat Prevention enforces security outcomes on allowed traffic, not just denied sessions
- Malware prevention occurs inline at the security policy layer
- User-visible block pages provide clear evidence of active inspection and enforcement

## Lab Environment
- Palo Alto Networks NGFW (VM-Series)
- Cisco routing and switching infrastructure
- EVE-NG virtual lab platform

## Status
Validated and complete.
